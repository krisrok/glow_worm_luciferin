<head>
    <title>Bootstrap 5 Example</title>
    <meta charset='utf-8'>
    <meta name='viewport' content='width=device-width, initial-scale=1'>
    <script src='https://code.jquery.com/jquery-3.6.0.slim.min.js' integrity='sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=' crossorigin='anonymous'></script>
    <link href='https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css' rel='stylesheet'>
    <script src='https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js'></script>
    <script src='https://cdn.jsdelivr.net/npm/@jaames/iro@5'></script>
    <style>
        body {
            background-color: #f8f8f8;
            font-wight: bold;
        }
        img, video, object, embed {
            max-width: 100%;
            height: auto;
            overflow: hidden !important;
        }

        button {
            width: 100%;
            min-height: 10vw;
        }

        .col-sm-12, col-sm-6, footer {
            margin: 2vw 0vw 2vw 0vw;
        }

        #toggleLED {
            height: 5vw;
            font-size: 3vw;
            font-weight: bold;
        }

        .wrap {
            max-width: 72vw;
            margin: 0 auto;
            display: flex;
            flex-direction: row;
            align-items: center;
            justify-content: center;


        }

    </style>

</head>
<body>

<div class='container-fluid p-5 bg-primary text-white text-center'>
    <h1>LUCIFERIN</h1>
    <p>Bias Lighting and Ambient Light firmware designed for Firefly Luciferin </p>
</div>
<div class='container'>
    <div class='row'>
        <div class='col' style='margin-top: 2vw;'>
            <form onsubmit='submitForm(event)'>
                <div class='form-group row'>


                    <div class='col-sm-12'>
                        <div class='wrap'>
                            <div id='picker'></div>
                        </div>
                    </div>

                    <div class='col-sm-12'>
                        <button id='toggleLED' type='button' class='btn btn-primary' data-bs-toggle='button'
                                autocomplete='off'>TOGGLE LEDs
                        </button>
                    </div>


                    <div class='col-sm-12'>
                        <div class='form-floating'>
                            <select class='form-select' id='effectSelect' aria-label='Floating label select example'>
                                <option value='solid'>Solid</option>
                                <option value='GlowWormWifi'>Bias light</option>
                                <option value='solid rainbow'>Solid rainbow</option>
                            </select>
                            <label for='effectSelect'>EFFECT</label>
                        </div>
                    </div>

                    <div class='col-sm-6'>
                        <div class='form-floating'>
                            <select class='form-select' id='gammaSelect'
                                    aria-label='Floating label select example'>
                                <option value='1'>One</option>
                                <option value='2'>Two</option>
                                <option value='3'>Three</option>
                            </select>
                            <label for='gammaSelect'>GAMMA</label>
                        </div>
                    </div>

                    <div class='col-sm-6'>
                        <div class='form-floating'>
                            <select class='form-select' id='whiteTempSelect' aria-label='Floating label select example'>
                                <option value='1'>One</option>
                                <option value='2'>Two</option>
                                <option value='3'>Three</option>
                            </select>
                            <label for='whiteTempSelect'>WHITE TEMPERATURE</label>
                        </div>
                    </div>


                </div>
            </form>
        </div>

    </div>

</div>
<footer class='bg-light text-center text-lg-start'>
    <div class='text-center p-3' style='margin-top: 3vw; '>
        <a class='text-dark' href='https://github.com/sblantipodi/'>Luciferin on GitHub</a>
    </div>
</footer>

<script type='text/javascript'>
    function callDevice(payload) {
        console.log(payload);
        const http = new XMLHttpRequest();
        http.open('GET', window.location.href + 'lights/glowwormluciferin/set?payload=' + payload);
        http.send();
        http.onload = () => console.log(http.responseText);
    }
    function createPayload() {
        var toggleLED = $('#toggleLED')[0];
        var payload = {
            state: toggleLED.classList.contains('active') ? 'ON' : 'OFF',
            effect: $('#effectSelect').val(),
            color: colorPicker.color.rgb,
            whitetemp: 1
        }
        return payload;
    }
    var colorPicker = new iro.ColorPicker('#picker', {
        width: 320,
        color: '#f00'
    });
    $('#floatingSelect').change(function () {
        var selectedItem = $('#floatingSelect').val();
        alert('ddasas' + selectedItem);
    });
    $('#toggleLED').click(function () {
            callDevice(JSON.stringify(createPayload()));
    });
    colorPicker.on('color:change', function(color) {
        // log the current color as a HEX string
        console.log(color.rgb);
    });
</script>
</body>
